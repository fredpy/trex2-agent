<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>trex: TREX A Teleo-Reactive Executive</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">trex
   &#160;<span id="projectnumber">0.3.3</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">TREX A Teleo-Reactive Executive </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is the documentation of TREX codename <a href="http://www.youtube.com/watch?v=RM9o4VnfHJU&amp;feature=channel_page">barreleye</a>. This version is the first TREX version that do not rely on Europa for its core functionalities as a result one can use TREX with which ever planner he wants - as long as this one can hanlde properly the goal representation expected by TREX.</p>
<h2><a class="anchor" id="install"></a>
Installing TREX</h2>
<h3><a class="anchor" id="install-requirement"></a>
Third party requirements</h3>
<p>TREX uses third party utilities and libraries. Here's sa list of them : </p>
<ul>
<li><b>rapidXML</b> (<a href="http://rapidxml.sourceforge.net/">http://rapidxml.sourceforge.net/</a>) This is used for configuration parsing. TREX used to rely on TinyXML version embedded in Europa but keeping this would have been annoying as this version was part of Europa and keeping the ability to connect to Europa while using a version of TinyXML which is not necessarily the Europa one would have been tricky. On top of that rapidxml is really lightweight (only templates defined in C++ headers) and very fast (performance close to strlen). The version used -- and provided -- for this package is 1.13. </li>
<li><b>boost</b> (<a href="http://www.boost.org">http://www.boost.org</a>) This library is widely used for basic utilities and compatibilty with the TR1 C++0x standard. As we use flyweight, boost graph and property tree the earliest version to be used is 1.47.0 (we tested it with boost 1.47.0 and 1.49.0).</li>
</ul>
<p>Others utilies are of interrest but not necessary to use TREX: </p>
<ul>
<li><em>doxygen</em> (<a href="http://www.doxygen.org/">http://www.doxygen.org/</a>) This utility is needed only if you want to generate this documentation. </li>
<li><em>graphviz</em> (<a href="http://www.graphviz.org/">http://www.graphviz.org/</a>) Recommended for documentation but it may also be used for plan visualization by showing tokens and their relations as a graph.</li>
</ul>
<dl class="section note"><dt>Note:</dt><dd>rapidxml is bundled into TREX. Nothing as been changed in this libray and if one prefers to use another version of this library he justs need to define the environment variable <code>TINY_XML_ROOT</code> with the directory where this one is before compiling TREX.</dd></dl>
<p>To compile trex libraries there's currently one approach supported: </p>
<ul>
<li><b>cmake</b> (<a href="http://www.cmake.org/">http://www.cmake.org/</a>) newly added which -- among other things -- allows to integrate trex2 in multiple IDEs such as Eclipse, Xcode, ...</li>
</ul>
<dl class="section warning"><dt>Warning:</dt><dd>We used to also support jam (<a href="http://www.perforce.com/jam/jam.html">http://www.perforce.com/jam/jam.html</a>) for historical reasonS. Still this tool became more and more problematic for the overal maintenance of the project. We have now decided to move fully to cmake.</dd></dl>
<h3><a class="anchor" id="install-env"></a>
Set your environment</h3>
<p>The <code>devConfig</code> <code>bash</code> file loads all the variables needed to be able to compile and execute TREX. If you are using bash you can edit your <code>~/</code>.profile (or <code>~/</code>.bash_profile depending on your configuration/platform). Considering that you have put TREX on the directory <code>&lt;trex-dir&gt;</code> you can put the following lines : </p>
<div class="fragment"><pre class="fragment">path=`pwd` 
cd &lt;trex-dir&gt; 
<a class="code" href="db/db4/group__transaction.html#ga2a1b6a59562d365f2260fad40f037a67" title="source of a relation">source</a> devConfig 
cd $path 
</pre></div> <dl class="section attention"><dt>Attention:</dt><dd>Under MacOS X you also need to define <code>DYLD_BIND_AT_LAUNCH</code> to allow dynamic library loading on the fly. Indeed, this version of TREX supports plugin allowing to define externally new reactors and components and MacOS X needs to be informed about that. To do so add the following line in your <code>~/</code>.profile : <div class="fragment"><pre class="fragment">export DYLD_BIND_AT_LAUNCH=YES
</pre></div></dd></dl>
<p>In order to be able to compile europa plugin you'll also need to set your EUROPA_HOME to the directory where europa is installed. For example </p>
<div class="fragment"><pre class="fragment">export EUROPA_HOME=${HOME}/europa
</pre></div><p> The expected structure from cmake is the following : </p>
<div class="fragment"><pre class="fragment">$EUROPA_HOME
  + lib        # europa libraries (we use the _o versions)
  + include    # PS*.hh headers
    + PLASMA   # plasma headers
</pre></div><p> This should be the case if you installed the binary package of europa</p>
<h3><a class="anchor" id="install-main"></a>
TREX general structure</h3>
<div class="image">
<img src="SWarchi.png" alt="SWarchi.png"/>
<div class="caption">
TREX Software architecture</div></div>
<p>This version of TREX is composed of multiples libraries and components which are organized as follow: </p>
<ul>
<li><b> Main libraries: </b> They are also called <em>module</em>. All of them are compiled into the <code>lib</code> directory. There's 4 of them described more in detail in this document : <ul>
<li>
<code>TREXutils</code> (trex/utils): A set of classes that represent basic functionallities that are used by TREX but are more based on generic programming paradigms and design patterns that could be used for other programs. </li>
<li>
<code>TREXdomains</code> (trex/domain): Definition of domains and variables as manipulated by TREX for information exchange between reactors. A variabl is defined by a name and a domain. A domain is a typed, possibly continuous, set of possible values for this varaible. A domain cannot be empty and can only be restricted. </li>
<li>
<code>TREXtransaction</code> (trex/transaction): This library define the reactors which is the basic component that can be composed inside TREX. It defines also Obsevations and Goals which are the data that can be exchanged between reactors. </li>
<li>
<code>TREXagent</code> (trex/agen): Defines the TREX agent. The agent is the main entity that manages the loading and execution of the reactors as their interaction. </li>
</ul>
</li>
<li><b> TREX commands (trex/cmds): </b> A set of simple commands that can be used to execute a TREX agent. They are compiled into the <code>bin</code> directory. There's two generic commands that gives a simple illustration on how one can create and manipulate an Agent : <ul>
<li>
<code>amc</code> : This program takes a configuration file as argument. Provided that this file defines correctly an Agent it will execute this agent until its end. </li>
<li>
<code>sim</code> : This program takes similar argument as <code>amc</code>. The difference here is that it provides a simple interface to run the agent in an interactive way allowing to step through clock ticks.  </li>
</ul>
</li>
<li><b> TREX plug-ins: </b> These are optionnally compiled and the source is usually located under <code>extra/&lt;name&gt;</code>. You can comile them by calling <code>jam</code> <code>&lt;name&gt;</code>. The result will be put under <code>extra</code> directory as a dynamic library named <code>TREX&lt;name&gt;</code>. </li>
<li><b> TREX documentation: </b> Generated from the source using <code>jam</code> <code>doc</code>. It will be installed on the <code>doc</code> directory. </li>
<li><b> TREX logs: </b> Usually generated under the <code>log</code> directory after any run of a TREX agent. </li>
<li><b> TREX utilities and scripts: </b> Under <code>offboard</code>. Provides a set of scripts and utilities to help the processing of TREX logs. </li>
<li><b> nightly build: </b> Under <code>nightly</code>,. Used to run nightly builds of the head. </li>
<li><b> Configurations files </b> Usually under <code>cfg</code>. A set of configuration files that can be used to define new agents and/or reactors.</li>
</ul>
<h3><a class="anchor" id="install-cmake"></a>
Compiling with cmake</h3>
<p>More details can be found on cmake <a href="http://www.cmake.org/cmake/help/runningcmake.html">official documentation</a>. But here's a quick tutorial to use make as the end compilation tool.</p>
<p>Create your working directory : </p>
<div class="fragment"><pre class="fragment">&gt; mkdir trex2.build
&gt; cd trex2.build 
</pre></div><p> run cmake by passing the location of the source tree as argument (we'll assume that trex2.build is ate the same level as trex2-agent source directory) </p>
<div class="fragment"><pre class="fragment">&gt; cmake ../trex2-agent/
-- The C compiler identification is GNU
-- The CXX compiler identification is GNU
-- Checking whether C compiler has -isysroot
-- Checking whether C compiler has -isysroot - yes
-- Checking whether C compiler supports OSX deployment <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> flag
-- Checking whether C compiler supports OSX deployment <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> flag - yes
-- Check <span class="keywordflow">for</span> working C compiler: /usr/bin/gcc
-- Check <span class="keywordflow">for</span> working C compiler: /usr/bin/gcc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Checking whether CXX compiler has -isysroot
-- Checking whether CXX compiler has -isysroot - yes
-- Checking whether CXX compiler supports OSX deployment <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> flag
-- Checking whether CXX compiler supports OSX deployment <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> flag - yes
-- Check <span class="keywordflow">for</span> working CXX compiler: /usr/bin/c++
-- Check <span class="keywordflow">for</span> working CXX compiler: /usr/bin/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Boost version: 1.46.1
-- Found the following Boost libraries:
--   system
-- Looking <span class="keywordflow">for</span> pthread_self in pthread
-- Looking <span class="keywordflow">for</span> pthread_self in pthread - found
-- Looking <span class="keywordflow">for</span> clock_gettime in rt
-- Looking <span class="keywordflow">for</span> clock_gettime in rt - not found
-- Looking <span class="keywordflow">for</span> dlopen in dl
-- Looking <span class="keywordflow">for</span> dlopen in dl - found
-- Configuring done
-- Generating done
-- Build files have been written to: /Users/fpy/Coding/trex2.build
</pre></div><p> If no error occured, you can just run make as usual </p>
<div class="fragment"><pre class="fragment">&gt; make
Scanning dependencies of <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXutils
[  3%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/ErrnoExcept.cc.o
[  6%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/Exception.cc.o
[  9%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/LogManager.cc.o
[ 12%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/Pdlfcn.cc.o
[ 15%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/PluginLoader.cc.o
[ 18%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/RStat.cc.o
[ 21%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/SingletonDummy.cc.o
[ 25%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/SingletonServer.cc.o
[ 28%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/TextLog.cc.o
[ 31%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/TREXversion.cc.o
[ 34%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXutils.dir/trex/utils/XmlUtils.cc.o
Linking CXX shared library libTREXutils.dylib
[ 34%] Built <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXutils
Scanning dependencies of <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXdomain
[ 37%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXdomain.dir/trex/domain/BasicEnumerated.cc.o
[ 40%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXdomain.dir/trex/domain/BasicInterval.cc.o
[ 43%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXdomain.dir/trex/domain/DomainBase.cc.o
[ 46%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXdomain.dir/trex/domain/DomainImpl.cc.o
[ 50%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXdomain.dir/trex/domain/Variable.cc.o
Linking CXX shared library libTREXdomain.dylib
[ 50%] Built <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXdomain
Scanning dependencies of <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXtransaction
[ 53%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXtransaction.dir/trex/transaction/Goal.cc.o
[ 56%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXtransaction.dir/trex/transaction/LogPlayer.cc.o
[ 59%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXtransaction.dir/trex/transaction/Observation.cc.o
[ 62%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXtransaction.dir/trex/transaction/Predicate.cc.o
[ 65%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXtransaction.dir/trex/transaction/reactor_graph.cc.o
[ 68%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXtransaction.dir/trex/transaction/Relation.cc.o
[ 71%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXtransaction.dir/trex/transaction/TeleoReactor.cc.o
[ 75%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXtransaction.dir/trex/transaction/TransactionLogger.cc.o
Linking CXX shared library libTREXtransaction.dylib
[ 75%] Built <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXtransaction
Scanning dependencies of <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXagent
[ 78%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXagent.dir/trex/agent/Agent.cc.o
[ 81%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXagent.dir/trex/agent/Clock.cc.o
[ 84%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXagent.dir/trex/agent/RealTimeClock.cc.o
[ 87%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXagent.dir/trex/agent/StepClock.cc.o
Linking CXX shared library libTREXagent.dylib
[ 87%] Built <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXagent
Scanning dependencies of <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXlightswitch
[ 90%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXlightswitch.dir/extra/lightswitch/LightSwitch.cc.o
Linking CXX shared library libTREXlightswitch.dylib
[ 90%] Built <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXlightswitch
Scanning dependencies of <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXvitre
[ 93%] Building CXX <span class="keywordtype">object</span> CMakeFiles/TREXvitre.dir/extra/vitre/Vitre.cc.o
Linking CXX shared library libTREXvitre.dylib
[ 93%] Built <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> TREXvitre
Scanning dependencies of <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> amc
[ 96%] Building CXX <span class="keywordtype">object</span> CMakeFiles/amc.dir/trex/cmds/AMC.cc.o
Linking CXX executable amc
[ 96%] Built <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> amc
Scanning dependencies of <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> sim
[100%] Building CXX <span class="keywordtype">object</span> CMakeFiles/sim.dir/trex/cmds/Sim.cc.o
Linking CXX executable sim
[100%] Built <a class="code" href="db/db4/group__transaction.html#ga58f6b7de7559390a21fa80cb97f848f3" title="target of a relation">target</a> sim
</pre></div><dl class="section note"><dt>Note:</dt><dd>right now camke integrates as much plug-ins as possible into the all target ther's no easy way to deactivate a plug-in in the compilation -- except editing CmakeLists.txt. We will probably change that in the future</dd></dl>
<p>You can install the output using the usual : </p>
<div class="fragment"><pre class="fragment">&gt; make install
</pre></div><p> By default everything iis installed under <code>/usr/local</code> and tou can source the file <code>/usr/local/shared/trex/trex_init</code>.bash to setup you environment. To change the target directory you can either use ccmake command and change CMAKE_INSTALL_PREFIX value or look on how to change this value with the cmake command you are using.</p>
<p>Finally, if you want ot generate this doc just do : </p>
<div class="fragment"><pre class="fragment">&gt; make doc
</pre></div><h2><a class="anchor" id="Running"></a>
an example</h2>
<p>So far this version of TREX do not provide that much illustrations but at least a simple one exist with the lightswitch, vitre and europa plug-ins. To use it you first need to compile your source and also the extra Vitre.jar program : </p>
<div class="fragment"><pre class="fragment">~$ cd trex2.build 
trex2.build$ make 
[...]
trex2.build$ make Vitre 
[...]
trex.build$
</pre></div><p>After having compile you can either install the binaries or set-up your enviroment to run the code from the build directory. For the later we generate locally the trex-devel.bash file that can be sourced </p>
<div class="fragment"><pre class="fragment">trex2.build$ <a class="code" href="db/db4/group__transaction.html#ga2a1b6a59562d365f2260fad40f037a67" title="source of a relation">source</a> trex_devel.bash
@encode


You can now start the simulation but beforehand we are going to give a look at 
the configuration files on $TREX_HOME/cfg used <span class="keywordflow">for</span> <span class="keyword">this</span> <span class="keywordtype">short</span> test. 
We are going to use 3 of them :
@li @c sample.cfg Is the mission config file
@li @c lighton.req and @c lightoff.req are files describing goals 
    that one can post interactivelly through the sim interface

The content of @c sample.cfg should looks similar to <span class="keyword">this</span> :
@code  
&lt;Agent name=<span class="stringliteral">&quot;sample&quot;</span> finalTick=<span class="stringliteral">&quot;100&quot;</span> &gt;
       &lt;Plugin name=<span class="stringliteral">&quot;TREXvitre&quot;</span>/&gt;
       &lt;Plugin name=<span class="stringliteral">&quot;TREXlightswitch&quot;</span>/&gt;
       &lt;Plugin name=<span class="stringliteral">&quot;TREXeuropa&quot;</span>/&gt;

       &lt;Light name=<span class="stringliteral">&quot;light&quot;</span> latency=<span class="stringliteral">&quot;0&quot;</span> lookahead=<span class="stringliteral">&quot;1&quot;</span> log=<span class="stringliteral">&quot;1&quot;</span> state=<span class="stringliteral">&quot;1&quot;</span>/&gt;

       &lt;EuropaReactor name=<span class="stringliteral">&quot;test&quot;</span> lookahead=<span class="stringliteral">&quot;20&quot;</span> latency=<span class="stringliteral">&quot;3&quot;</span> 
                    solverConfig=<span class="stringliteral">&quot;test.solver.xml&quot;</span> /&gt;
       &lt;EuropaReactor name=<span class="stringliteral">&quot;test2&quot;</span> lookahead=<span class="stringliteral">&quot;20&quot;</span> latency=<span class="stringliteral">&quot;3&quot;</span> 
                    solverConfig=<span class="stringliteral">&quot;test.solver.xml&quot;</span> /&gt;

       &lt;VitreReactor name=<span class="stringliteral">&quot;switchView&quot;</span> latency=<span class="stringliteral">&quot;0&quot;</span> lookahead=<span class="stringliteral">&quot;0&quot;</span>
                     log=<span class="stringliteral">&quot;0&quot;</span> port=<span class="stringliteral">&quot;31415&quot;</span>&gt;
         &lt;External name=<span class="stringliteral">&quot;light&quot;</span> goals=<span class="stringliteral">&quot;0&quot;</span>/&gt;
         &lt;External name=<span class="stringliteral">&quot;switch&quot;</span> goals=<span class="stringliteral">&quot;0&quot;</span>/&gt;
         &lt;External name=<span class="stringliteral">&quot;lum&quot;</span> goals=<span class="stringliteral">&quot;0&quot;</span>/&gt;
         &lt;External name=<span class="stringliteral">&quot;lum2&quot;</span> goals=<span class="stringliteral">&quot;0&quot;</span>/&gt;
       &lt;/VitreReactor&gt;

      &lt;Goal on=<span class="stringliteral">&quot;lum&quot;</span> pred=<span class="stringliteral">&quot;Bright&quot;</span>&gt;
        &lt;Variable name=<span class="stringliteral">&quot;end&quot;</span>&gt;&lt;<span class="keywordtype">int</span> min=<span class="stringliteral">&quot;10000&quot;</span>/&gt;&lt;/Variable&gt;
      &lt;/Goal&gt;

      &lt;Goal on=<span class="stringliteral">&quot;lum2&quot;</span> pred=<span class="stringliteral">&quot;Dim&quot;</span>&gt;
       &lt;Variable name=<span class="stringliteral">&quot;start&quot;</span>&gt;&lt;<span class="keywordtype">int</span> min=<span class="stringliteral">&quot;20&quot;</span>/&gt;&lt;/Variable&gt;
        &lt;Variable name=<span class="stringliteral">&quot;end&quot;</span>&gt;&lt;<span class="keywordtype">int</span> min=<span class="stringliteral">&quot;10000&quot;</span>/&gt;&lt;/Variable&gt;
      &lt;/Goal&gt;
&lt;/Agent&gt;
</pre></div><p> The <code>Agent</code> tag declare the global agent with its <code>name</code> and <code>finalTick</code> both of them can be freely modified.</p>
<p>The <code>Plugin</code> tag indicates that this mission need to load the <code>TREXlightswitch</code> plug-in. Based on that <code>sim</code> will automatically look on local directory and <code>TREX_PATH</code> to locate this plug-in.</p>
<p>The <code>Light</code> declare a reactor which is implemented in <code>TREXlightswitch</code>. This one starts with a <code>state</code> of 1 which mean that its light is on. You can change it to 0 if you want to start with the light off.</p>
<p>The <code>EuropaReactor</code> declare a reactor which is implemented in <code>TREXeuropa</code>. These two reactors are keeping track on the light to know if the luminance is bright or dark. and can switch the light on the desired state according to their objectives.</p>
<p>The <code>VitreReactor</code> declare a reactor that will connect to the Vitre.jar graphic interface in order to visualize the state of each timeline. The "External" tags specifies which timelines this reactor needs to look at. Feel free to change these.</p>
<p>Finally the two Goal at the end gives the objectives for each EuropaReactor. Quickly stated : <code>test</code> will want to be on a Bright state at the end of the mission while <code>test2</code> will want to be Dim at the end of the mission starting from the tick 20</p>
<h3><a class="anchor" id="start"></a>
the @c sample mission</h3>
<p>To start the sample mission you can do the following : </p>
<ul>
<li>start Vitre java application <div class="fragment"><pre class="fragment">trex2.build$ java -jar Vitre.jar
</pre></div> </li>
<li>start the simulation in "debug" mode : <div class="fragment"><pre class="fragment">trex2.build$ sim sample
This is TREX v0.1.3
Options:
  Q :- quit
  N :- next tick
  G :- <span class="keywordflow">goto</span> tick (e.g. g100)
  P :- post the goals from the attached file
       (e.g P goal.req)
  K :- kill one reactor (e.g K foo)
  H :- print this help message
[sample:0]&gt; 
</pre></div> The mission is loaded and the prompt indicate the name of the agent (sample) and the current tick value 0. You can use commands to interact with the agent by advancing of one tick (N), go to a given tick in the future (G) or post a request described in a file (P)</li>
</ul>
<p>you can also in an alternate terminal look on the activity of the agent redicrected in <code>$TREX_LOG_DIR/latest/TREX</code>.log </p>
<div class="fragment"><pre class="fragment">~$ cd $TREX_LOG_DIR
log$ tail -F latest/TREX.log
[lightswitch] LightSwitch loaded.
</pre></div><p> At this stage it indicate the lightsiwtch plug-in was successfully loaded. But as the mission you'll see other messages including new observations on timelines (ASSERT), requests, ...</p>
<p>This is especially true as the two reactors test and test2 will compete to have the light on or off starting from the tick 20.</p>
<p>Going back to the sim shell you can then uses the command to switch the lights on or off on your reactor. For example </p>
<div class="fragment"><pre class="fragment">Options:
  Q :- quit
  N :- next tick
  G :- <span class="keywordflow">goto</span> tick (e.g. g100)
  P :- post the goals from the attached file
       (e.g P goal.req)
  K :- kill one reactor (e.g K foo)
  H :- print this help message
[sample:0]&gt; n
[sample:1]&gt; P lighton
Loading &quot;/Users/fpy/Coding/TREX2/cfg/lighton.req&quot;... done
Extracting goals:
 - light.Light.On
[sample:1]&gt; n
[sample:2]&gt; g10
[sample:10]&gt; p lightoff
Loading &quot;/Users/fpy/Coding/TREX2/cfg/lightoff.req&quot;... done
Extracting goals:
 - light.Light.Off
[sample:10]&gt; n
[sample:11]&gt; g1000
Mission completed.
TREX2$
</pre></div><dl class="section note"><dt>Note:</dt><dd>The ticks are not in real-time in <code>sim</code>. This is related to the fact that <code>sim</code> needs to be able to interrupt the clock and restart it. We plan to implement a pseudo real-time clakc but most of the time the we use <code>sim</code> to replay a past mission (using a LogPlayer reactor which is not provided yet on this version) and as these can be long (hours) the fast sim clock is a better fit.</dd>
<dd>
At this stage this is the only mission directly available on TREX. This is due to the fact that our effort was more focused on make TREX independent from Europa than implement a large set of reactors. The porting of other reactors (Log player, europa 2.1.1 based, latest europa based, ... ) are in the process and should be available soon. </dd></dl>
</div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu May 10 2012 11:09:57 for trex by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
