#include "TREX.nddl"

class Light extends AgentTimeline {
    predicate On {}
    predicate Off {}

    Light(Mode _mode) {
	super(_mode);
    }
}

class Switch extends AgentTimeline {
    predicate Up {}
    predicate Down {}

    Switch(Mode _mode) {
	super(_mode);
    }
}

class LightSwitch extends Timeline {
    Switch controlled;
    
    predicate turnOff { duration = 1; }
    predicate turnOn { duration = 1; }

    LightSwitch(Switch sw) {
	controlled = sw;
    }
}

class Luminance extends AgentTimeline {
    predicate Bright {}
    predicate Dim {}
    
    Luminance(Mode _mode) {
	super(_mode);
    }
}


LightSwitch::turnOn {
    meets(object.controlled.Down);
}

LightSwitch::turnOff {
    meets(object.controlled.Up);
}

Luminance::Bright {
    met_by(LightSwitch.turnOn);
}

Luminance::Dim {
    met_by(LightSwitch.turnOff);
}

Light::On {
    starts(Switch.Down click);
    precedes(end, click.end);
    contained_by(Luminance.Bright);    
}


Light::Off {
    contained_by(Luminance.Dim);
}

Switch::Up {
    contained_by(Light.Off);
    met_by(Down);
}

Switch::Down {
    met_by(Up);
}

